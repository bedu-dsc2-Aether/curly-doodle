```{python}
from io import BytesIO
from zipfile import ZipFile
from urllib.request import urlopen
import requests
import pandas as pd
```

```{python}
database = []
resp = urlopen('https://www.cdc.gov/brfss/annual_data/2022/files/LLCP2022ASC.zip')
myzip = ZipFile(BytesIO(resp.read()))
filename = myzip.namelist()[0]
for line in myzip.open(filename).readlines():
    database.append(line.decode('utf-8'))

database_df = pd.DataFrame(database)
print(database_df)
```

```{python}
# Save a sample of the data in a CSV file to test code without downloading the zip file every time
database_df.sample(n=100,axis='index').to_csv('DataSample.csv', header=False, index=False)
```

```{python}
# Read the sample data in the CSV file to a datafarame
dbsample_df = pd.read_csv('DataSample.csv',header=None)
print(dbsample_df)
```

```{python}
# Access the CDC website and store in a data frame the table that describes the layout of the variables in the ASC file
url = 'https://www.cdc.gov/brfss/annual_data/2022/llcp_varlayout_22_onecolumn.html'
html = requests.get(url).content
table_list = pd.read_html(html)
layout_df = table_list[-1]
layout_df.to_csv('VariableLayout.csv', index=False)
print(layout_df)
```

```{python}
# Read the Variable Layout in the CSV file to a datafarame
layout_df = pd.read_csv('VariableLayout.csv')
print(layout_df)
```

```{python}
# split_df = 
for index, row in layout_df.iterrows():
    a = row['Starting Column']
    b = row['Field Length']
    name = row['Starting Column']
```